---
slug: /building-web3-apps/authenticating-users/quickstart
title: Quickstart
---

Let's take a look at a quick example of how to use the authentication SDK to allow users on a frontend application to login with just their wallets to a backend and make authenticated requests.

## Setup the Project

We'll start by cloning the [Basic Authentication](https://github.com/thirdweb-example/sign-in-with-ethereum) example project with the following command:

```bash
git clone https://github.com/thirdweb-example/sign-in-with-ethereum
```

This project has all the code we'll need to try out the authentication SDK. After cloning the project, run one the following commands to install the necessary dependencies:

```bash
npm install
# or
yarn install
```

We also need to setup our backend with an admin private key we can use to generate authentication tokens (we'll explore what this means later). To do this, we need to create a new file in the top-level of our project called `.env.local` and add our private key to the file:

```.env.local
ADMIN_PRIVATE_KEY=...
```

Make sure to replace the "..." with your actual private key - you can find or export your private key from your respective wallet app - for example, you can find your private key in MetaMask by going to `3 Dots` > `Account Details` > `Export Private Key`.

:::warning

Make sure to never give away your private key or commit it to file history! In this case, our `.env.local` file is in the `.gitignore` which means it wont be tracked by `git`.

:::

### Trying the Demo

Now that our project is setup, we can run it and see what's going on. To do this, we'll run one of the following commands:

```bash
npm run dev
# or
yarn dev
```

Now our project should be running on our localhost. You can navigate to [http://localhost:3000](http://localhost:3000) and you should see a page that looks like the following (assuming your wallet isn't already connected to the page).

![Connect Wallet](./assets/connect-wallet.png)

The first thing to do is to connect your MetaMask wallet to the page by clicking the `Connect Wallet` button (if you don't have MetaMask on your browser, you can get it [here](https://metamask.io/download/)).

Once you connect your wallet, the page should update to the following, reflected your connect wallet address in the `Connect Address` section.

![Login with Wallet](./assets/login-with-wallet.png)

At this point, we've simply connected our wallet to the page, so only the browser knows what our wallet address is.

However, now we want to login to the backend with our wallet. In order to log in, we need to prove to the backend that we do in fact own the wallet address that's connected on the frontend, and then the backend will issue us an authentication token that we can use to make authenticated requests.

We can prove this to the backend by signing a specific login message with our private key, which the backend will then use to verify that we do in fact own the address we claim to have.

You can do this step by clicking the `Login with Wallet` button, and you should be prompted to sign a message that looks something like the following (with different addresses, times, and nonce).

```
thirdweb.com wants you to sign in with your account:
0x9e1b8A86fFEE4a7175DAE4bDB1cC12d111Dcb3D6

Make sure that the requesting domain above matches the URL of the current website.

Nonce: f44b81a7-2547-40a4-8583-59f9be41e9f3
Expiration Time: 2022-07-06T15:22:54.829Z
```

Once you sign the message, it will get sent to the backend where the backend will verify your address and generate an authentication token to send to you.

:::tip

For those curious, you can actually see the authentication token by clicking `Inspect` > `Application` > `Cookies` and you'll see it under the `access_token` cookie in this case.

:::

Now that you're logged in, your page should update to the following with the correct `Logged In Address`.

![Authenticate](./assets/authenticate.png)

Our authentication token is now stored securely on the frontend, so if we make any future requests to the backend, the backend will still know the wallet address that we are logged in as.

You can try this out by clicking the `Authenticate` button, which just makes a request to the backend and returns `true` if you're wallet address is still authenticated.

Finally, if you try clicking the `Logout` button, the authentication token will be removed from the frontend, which means you will no longer be able to make authenticated requests. If try the `Authenticate` button, it should now show `false` for the `Authenticated` value, reflecting that you are no longer logged in.

So just like that, we have a **full login-flow where you can login to a backend with just a wallet!**

### Understanding the Code

Now that we've seen the basics of what this login flow can do, let's take a look at the important code to try to understand what's going on.

The first file we can take a look at is the `hooks/useAuthenticate.ts` file, which will have functions called `login`, `authenticate`, and `logout`. Notice that all of these functions are simply making API requests to the backend, which we'll take a look at soon. However,
if we take a closer look at the `login` function, you'll notice that's its also doing something else:

```typescript
async function login() {
  // Here, we call the authentication SDK login method to generate a payload we can send to the backend
  const payload = await sdk?.auth.login(domain);
  await fetch("/api/login", {
    method: "POST",
    headers: {
      "Content-Type": "application/json",
    },
    body: JSON.stringify({ payload }),
  });
}
```

In this function, we importantly call the `sdk.auth.login()` function which is what prompts the connected wallet to sign a message, which is then used to generate a payload to send to the backend.

Now we can take a look at all the API functions which enable these flows. First, let's look at `pages/api/login.tsx`, which is where the login request is made. The most crucial line in this function is the following:

```typescript
const token = await sdk.auth.generateAuthToken(domain, payload);
```

Here, we take the payload generated and send from the frontend and use it to create an authentication token that the frontend can use to make authenticated requests. We then send this token back to the frontend as a secure cookie with the following code:

```typescript
res.setHeader(
  "Set-Cookie",
  serialize("access_token", token, {
    path: "/",
    httpOnly: true,
    secure: true,
    sameSite: "strict",
  }),
);
```

Next, let's look at the `pages/api/authenticate.tsx` file, which showcases a separate API endpoint where we can verify is a user is logged in or not. The most important code here is the following:

```typescript
// Get access token off cookies
const token = req.cookies.access_token;
if (!token) {
  res.status(401).json({
    error: "Must provide an access token to authenticate",
  });
}

const sdk = ThirdwebSDK.fromPrivateKey(
  process.env.ADMIN_PRIVATE_KEY as string,
  "mainnet",
);

// Authenticate token with the SDK
const domain = "thirdweb.com";
const address = await sdk.auth.authenticate(domain, token);
```

Here, we extract the authentication token off the request cookies and verify it with the `sdk.auth.authenticate` method. If the authentication token is valid, the function will return us the address of the authenticated wallet, otherwise this function will throw an error.

Finally, let's look at the `pages/api/logout.tsx` file, which demonstrates how to logout a user. All we have to do is remove the cookie with the authentication token from the frontend (which we can specify on the request with the following):

```typescript
// Set the access token to 'none' and expire in 5 seconds
res.setHeader(
  "Set-Cookie",
  serialize("access_token", "none", {
    path: "/",
    expires: new Date(Date.now() + 5 * 1000),
  }),
);
```

And with this, the user will be logged out after 5 seconds.

And just like that, user authentication with the authentication SDK is made possible!
